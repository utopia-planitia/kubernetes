apiVersion: v1
kind: Pod
metadata:
  name: resources-webhook
  namespace: kube-system
spec:
  hostNetwork: true
  containers:
    - name: default-resources-webhook
      image: "pandorasnox/kubernetes-default-container-resources:1.3.0"
      command:
        - "/kubernetes-default-container-resources"
      ports:
        - containerPort: {{ resources_webhook_port }}
      args:
        #- "-tlsDisabled=true"
        - -addr=:{{ resources_webhook_port }}
        - -sslCert=/etc/resources-webhook/ssl/server.pem
        - -sslKey=/etc/resources-webhook/ssl/server-key.pem
      env:
        - name: CONFIG_HASH
          value: {{ resources_webhook_config_hash }}
      #livenessProbe:
      #  tcpSocket:
      #    port: { resources_webhook_port }}
      #resources:
      #  requests:
      #    cpu: { etcd_requests_cpu }}
      #    memory: { etcd_requests_memory }}
      #  limits:
      #    cpu: { etcd_limits_cpu }}
      #    memory: { etcd_limits_memory }}
      volumeMounts:
        - name: certs
          mountPath: /etc/resources-webhook/ssl
  volumes:
    - name: certs
      hostPath:
        path: /etc/resources-webhook/ssl
