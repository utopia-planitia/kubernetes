apiVersion: v1
kind: List
items:
  - apiVersion: v1
    kind: ConfigMap
    metadata:
      name: local-volume-config
      namespace: kube-system
    data:
      storageClassMap: |
        local-storage:
          hostDir: "/var/lib/local-storage"
          mountDir: "/local-storage"
  - apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: local-storage-bootstrapper
      namespace: kube-system
  - apiVersion: rbac.authorization.k8s.io/v1beta1
    kind: ClusterRoleBinding
    metadata:
      name: local-storage:bootstrapper
    subjects:
    - kind: ServiceAccount
      name: local-storage-bootstrapper
      namespace: kube-system
    roleRef:
      kind: ClusterRole
      name: cluster-admin
      apiGroup: rbac.authorization.k8s.io
  - apiVersion: batch/v1
    kind: Job
    metadata:
      name: local-volume-provisioner-bootstrap
      namespace: kube-system
      labels:
        app: local-volume-provisioner-bootstrap
    spec:
      template:
        spec:
          serviceAccountName: local-storage-bootstrapper
          restartPolicy: Never
          containers:
          - name: bootstrapper
            image: quay.io/external_storage/local-volume-provisioner-bootstrap:v2.0.0
            env:
            - name: MY_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            args:
            - --image=quay.io/external_storage/local-volume-provisioner:v2.2.0
            - --volume-config=local-volume-config
